Sub stocks1()Dim ticker As StringDim open_price As StringDim close_price As StringDim stock_volume As StringDim Summary_table_row As StringDim ws As WorksheetDim year_change1 As StringDim year_change2 As StringDim rng As RangeDim greatest_inc As StringDim greatest_dec As StringDim greatest_vol As StringFor Each ws In Worksheetsws.ActivateRange("I1").Value = "Ticker"Range("j1").Value = "Yearly Change"Range("k1").Value = "Percent Change"Range("l1").Value = "Total Stock Volume"Range("o2").Value = "Greatest % increase"Range("o3").Value = "Greatest % Decrease"Range("o4").Value = "Greatest Total Volume"Summary_table_row = 2open_price = Cells(2, 3).Valuestock_volume = 0lastrow = Cells(Rows.Count, 1).End(xlUp).RowFor i = 2 To lastrow        If Cells(i + 1, 1).Value <> Cells(i, 1).Value And open_price <> 0 Then    ticker = Cells(i, 1).Value    close_price = Cells(i, 6).Value    year_change1 = (close_price / open_price)    year_change2 = year_change1 - 1    stock_volume = stock_volume + Cells(i, 7).Value             Range("i" & Summary_table_row).Value = ticker    Range("j" & Summary_table_row).Value = close_price - open_price    Range("k" & Summary_table_row).Value = FormatPercent(year_change2)    Range("l" & Summary_table_row).Value = stock_volume    Summary_table_row = Summary_table_row + 1        open_price = Cells(i + 1, 3).Value    stock_volume = 0     With Range("k" & Summary_table_row - 1).FormatConditions.Add(xlCellValue, xlGreaterEqual, "0")        With .Interior        .ColorIndex = 4        End With         With Range("l" & Summary_table_row)         .ColumnWidth = 18      End With    End With   With Range("k" & Summary_table_row - 1).FormatConditions.Add(xlCellValue, xlLess, "0")    With .Interior        .ColorIndex = 3     End With      With Range("l" & Summary_table_row)     .ColumnWidth = 18     End With      With Range("o" & Summary_table_row)     .ColumnWidth = 22     End WithEnd With   Else           stock_volume = stock_volume + Cells(i, 7).Value    End If        Next iSet rng = Columns(11)Set rng2 = Columns(12)greatest_inc = FormatPercent(Application.WorksheetFunction.Max(rng))greatest_dec = FormatPercent(Application.WorksheetFunction.Min(rng))greatest_vol = Application.WorksheetFunction.Max(rng2)Range("p2").Value = greatest_incRange("p3").Value = greatest_decRange("p4").Value = greatest_volNext wsEnd Sub